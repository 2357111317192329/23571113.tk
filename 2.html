<!DOCTYPE html>
<html>
<body>
<canvas id="canvas"></canvas>
<script>
window.onload = function() {
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var img = new Image();
    img.crossOrigin = "";
    img.src = 'https://imgur.com/u72ml4B';
    img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0, img.width, img.height);
        var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        for (var i = 0; i < imageData.data.length; i += 4) {
            imageData.data[i] = Math.max(0, imageData.data[i] - Math.floor(Math.random() * 101));
            imageData.data[i+1] = Math.max(0, imageData.data[i+1] - Math.floor(Math.random() * 101));
            imageData.data[i+2] = Math.max(0, imageData.data[i+2] - Math.floor(Math.random() * 101));
        }
        ctx.putImageData(imageData, 0, 0);
    };
    var img = new Image();
    img.crossOrigin = "";
    img.onload = test;
    img.src = "https://i.imgur.com/fHyEMsl.jpg";
    
    function test() {
    
      var ctx = document.querySelector("canvas").getContext("2d");
      ctx.drawImage(this, 0, 0);
      
      // This will fail if no CORS support, otherwise all OK
      try {
        ctx.getImageData(0, 0, 10, 10);
        alert("All OK");
      } 
      catch(err) {
        alert("No CORS support...");
      }
    }
};
</script>

